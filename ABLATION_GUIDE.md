## ğŸ”¬ æ¶ˆèå®éªŒå®Œæ•´æŒ‡å—

### ğŸ“‹ ä»€ä¹ˆæ˜¯æ¶ˆèå®éªŒï¼Ÿ

**æ¶ˆèå®éªŒï¼ˆAblation Studyï¼‰** æ˜¯æœºå™¨å­¦ä¹ ç ”ç©¶ä¸­çš„æ ‡å‡†æ–¹æ³•ï¼Œç”¨äºç³»ç»ŸåŒ–åœ°è¯„ä¼°æ¨¡å‹ä¸­æ¯ä¸ªç»„ä»¶çš„è´¡çŒ®ã€‚

é€šè¿‡é€æ­¥æ·»åŠ /ç§»é™¤ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
1. âœ… é‡åŒ–æ¯ä¸ªæ”¹è¿›çš„æ•ˆæœ
2. âœ… å‘ç°å“ªäº›æ”¹è¿›æœ€æœ‰ä»·å€¼
3. âœ… ç†è§£å„ç»„ä»¶ä¹‹é—´çš„äº¤äº’
4. âœ… ä¸ºè®ºæ–‡/æŠ¥å‘Šæä¾›å®éªŒä¾æ®

---

## ğŸ¯ æˆ‘ä»¬çš„æ¶ˆèå®éªŒè®¾è®¡

### å®éªŒçŸ©é˜µ

| å®éªŒID | æ¨¡å‹é…ç½® | é¢„æœŸAUC | è®­ç»ƒæ—¶é—´ |
|--------|---------|---------|---------|
| 1 | **åŸºçº¿**: BiLSTMåŒå¡” | 0.9718 | åŸºå‡† |
| 2 | åŸºçº¿ + æ³¨æ„åŠ›æœºåˆ¶ | 0.9730 | +10% |
| 3 | åŸºçº¿ + ç‰¹å¾å·¥ç¨‹ï¼ˆ19ä¸ªï¼‰ | 0.9735 | +20% |
| 4 | åŸºçº¿ + Focal Loss | 0.9725 | +0% |
| 5 | åŸºçº¿ + æ•°æ®å¢å¼º | 0.9730 | +15% |
| 6 | åŸºçº¿ + å¯¹æ¯”å­¦ä¹  | 0.9740 | +25% |
| 7 | åŸºçº¿ + Transformer | 0.9750 | -30% |
| 8 | åŸºçº¿ + é¢„è®­ç»ƒè¯å‘é‡ | 0.9745 | +10% |
| 9 | å…¨éƒ¨æ”¹è¿›ï¼ˆå•ç‹¬ï¼‰ | 0.9760+ | +50% |
| 10 | å…¨éƒ¨æ”¹è¿›ï¼ˆç»„åˆï¼‰ | 0.9770+ | +60% |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šä½¿ç”¨Shellè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /home/xinguanze/class/ml2

# å¿«é€Ÿæµ‹è¯•ï¼ˆæ¯ä¸ªå®éªŒ3ä¸ªepochï¼Œçº¦30åˆ†é’Ÿï¼‰
chmod +x run_ablation.sh
./run_ablation.sh 3

# æ ‡å‡†å®éªŒï¼ˆæ¯ä¸ªå®éªŒ5ä¸ªepochï¼Œçº¦50åˆ†é’Ÿï¼‰
./run_ablation.sh 5

# å®Œæ•´å®éªŒï¼ˆæ¯ä¸ªå®éªŒ10ä¸ªepochï¼Œçº¦100åˆ†é’Ÿï¼‰
./run_ablation.sh 10
```

### æ–¹æ³•2ï¼šç›´æ¥Pythonå‘½ä»¤

```bash
# åŸºæœ¬ç”¨æ³•
python ablation_study.py --epochs 5

# è‡ªå®šä¹‰è¾“å‡ºç›®å½•
python ablation_study.py --epochs 5 --output_dir my_results

# æŸ¥çœ‹å¸®åŠ©
python ablation_study.py --help
```

---

## ğŸ“Š å®éªŒè¾“å‡º

è¿è¡Œå®Œæˆåï¼Œä¼šåœ¨ `ablation_results/` ç›®å½•ä¸‹ç”Ÿæˆï¼š

### 1. ğŸ“„ results.json
```json
{
  "results": [
    {
      "model_name": "1_Baseline_BiLSTM",
      "best_val_auc": 0.9718,
      "final_accuracy": 0.9252,
      "training_time": 300.5
    },
    ...
  ],
  "config": {...}
}
```

### 2. ğŸ“Š comparison.csv
```csv
model_name,best_val_auc,final_accuracy,final_f1,training_time,auc_improvement
1_Baseline_BiLSTM,0.9718,0.9252,0.9029,300.5,0.00
2_Baseline+Attention,0.9730,0.9265,0.9045,330.2,+0.12
3_Baseline+Features,0.9735,0.9270,0.9050,360.8,+0.17
...
```

### 3. ğŸ“ˆ ablation_comparison.png
4ä¸ªå­å›¾çš„å¯¹æ¯”å›¾è¡¨ï¼š
- AUCå¯¹æ¯”
- ç›¸å¯¹æå‡
- è®­ç»ƒæ—¶é—´
- F1åˆ†æ•°

### 4. ğŸ“ REPORT.md
å®Œæ•´çš„Markdownæ ¼å¼æŠ¥å‘Šï¼ŒåŒ…å«ï¼š
- å®éªŒé…ç½®
- ç»“æœæ€»è§ˆè¡¨æ ¼
- å…³é”®å‘ç°
- æœ€ä½³æ¨¡å‹
- å„æ”¹è¿›è´¡çŒ®
- ç»“è®º

---

## ğŸ” å½“å‰å®ç°çš„å®éªŒ

### âœ… å·²å®ç°ï¼ˆ4ä¸ªï¼‰

1. **å®éªŒ1ï¼šåŸºçº¿æ¨¡å‹**
   - BiLSTMåŒå¡” + äº¤äº’å±‚
   - ä½œä¸ºå¯¹æ¯”åŸºå‡†

2. **å®éªŒ2ï¼šåŸºçº¿ + æ³¨æ„åŠ›æœºåˆ¶**
   - æ·»åŠ self-attention
   - å…³æ³¨å…³é”®è¯

3. **å®éªŒ3ï¼šåŸºçº¿ + ç‰¹å¾å·¥ç¨‹**
   - 19ä¸ªæ‰‹å·¥ç‰¹å¾
   - é•¿åº¦ã€é‡å ã€ç›¸ä¼¼åº¦ç­‰

4. **å®éªŒ4ï¼šåŸºçº¿ + Focal Loss**
   - éš¾æ ·æœ¬åŠ æƒ
   - æå‡è¾¹ç•Œæ ·æœ¬æ€§èƒ½

### ğŸš§ å¾…æ‰©å±•ï¼ˆ6ä¸ªï¼‰

5. **å®éªŒ5ï¼šåŸºçº¿ + æ•°æ®å¢å¼º**
   ```python
   # åœ¨ablation_study.pyä¸­æ·»åŠ :
   def run_data_augmentation_experiment(self, epochs=5):
       # å®ç°æ•°æ®å¢å¼ºé€»è¾‘
       pass
   ```

6. **å®éªŒ6ï¼šåŸºçº¿ + å¯¹æ¯”å­¦ä¹ **
7. **å®éªŒ7ï¼šåŸºçº¿ + Transformer**
8. **å®éªŒ8ï¼šåŸºçº¿ + é¢„è®­ç»ƒè¯å‘é‡**
9. **å®éªŒ9ï¼šæ‰€æœ‰æ”¹è¿›ï¼ˆå•ç‹¬ï¼‰**
10. **å®éªŒ10ï¼šæ‰€æœ‰æ”¹è¿›ï¼ˆç»„åˆï¼‰**

---

## ğŸ“– å¦‚ä½•æ·»åŠ æ–°å®éªŒ

### æ­¥éª¤1ï¼šå®ç°æ–°æ¨¡å‹

```python
# åœ¨ model_new.py ä¸­
class NewModel(nn.Module):
    def __init__(self, ...):
        super().__init__()
        # å®ç°ä½ çš„æ¨¡å‹
    
    def forward(self, query1, query2):
        # å‰å‘ä¼ æ’­
        return logits
```

### æ­¥éª¤2ï¼šåœ¨æ¶ˆèå®éªŒä¸­æ·»åŠ 

```python
# åœ¨ ablation_study.py ä¸­æ·»åŠ æ–°æ–¹æ³•
def run_new_experiment(self, epochs=5):
    """å®éªŒX: åŸºçº¿ + æ–°æ”¹è¿›"""
    from model_new import create_new_model
    
    model = create_new_model()
    result = self.train_single_experiment(
        model, "X_Baseline+NewImprovement", epochs
    )
    
    self.log_experiment(
        experiment_id=X,
        name="Baseline + New Improvement",
        description="æè¿°æ–°æ”¹è¿›",
        improvements=["New Improvement"]
    )
    
    return result

# åœ¨ run_all_experiments() ä¸­è°ƒç”¨
def run_all_experiments(self, epochs_per_experiment=5):
    # ... ç°æœ‰å®éªŒ ...
    
    # æ·»åŠ æ–°å®éªŒ
    self.run_new_experiment(epochs_per_experiment)
```

### æ­¥éª¤3ï¼šè¿è¡Œå®éªŒ

```bash
python ablation_study.py --epochs 5
```

---

## ğŸ’¡ å®éªŒå»ºè®®

### å¿«é€Ÿè¿­ä»£ï¼ˆå¼€å‘é˜¶æ®µï¼‰
```bash
# åªè®­ç»ƒ3ä¸ªepochï¼Œå¿«é€ŸéªŒè¯
./run_ablation.sh 3
```
**ç”¨é€”**ï¼š
- éªŒè¯ä»£ç æ­£ç¡®æ€§
- å¿«é€Ÿçœ‹è¶‹åŠ¿
- Debug

### æ ‡å‡†å®éªŒï¼ˆè¯¾ç¨‹ä½œä¸šï¼‰
```bash
# è®­ç»ƒ5ä¸ªepochï¼Œå¹³è¡¡é€Ÿåº¦å’Œæ•ˆæœ
./run_ablation.sh 5
```
**ç”¨é€”**ï¼š
- è¯¾ç¨‹ä½œä¸šæäº¤
- åˆæ­¥æ€§èƒ½è¯„ä¼°
- å¯¹æ¯”åˆ†æ

### å®Œæ•´å®éªŒï¼ˆè®ºæ–‡/ç«èµ›ï¼‰
```bash
# è®­ç»ƒ10ä¸ªepochï¼Œå……åˆ†è®­ç»ƒ
./run_ablation.sh 10
```
**ç”¨é€”**ï¼š
- å‘è¡¨è®ºæ–‡
- ç«èµ›æäº¤
- æœ€ç»ˆç»“æœ

---

## ğŸ“Š ç»“æœè§£è¯»ç¤ºä¾‹

å‡è®¾è¿è¡Œ `./run_ablation.sh 5` åå¾—åˆ°ï¼š

```
| å®éªŒID | æ¨¡å‹åç§° | AUC | ç›¸å¯¹æå‡ |
|--------|---------|-----|---------|
| 1 | Baseline | 0.9718 | +0.00% |
| 2 | +Attention | 0.9730 | +0.12% |
| 3 | +Features | 0.9735 | +0.17% |
| 4 | +FocalLoss | 0.9725 | +0.07% |
```

### è§£è¯»ï¼š
1. âœ… **æ³¨æ„åŠ›æœºåˆ¶**æœ€æœ‰æ•ˆï¼ˆ+0.12%ï¼‰
2. âœ… **ç‰¹å¾å·¥ç¨‹**æ¬¡ä¹‹ï¼ˆ+0.17%ï¼‰
3. âš ï¸ **Focal Loss**æå‡è¾ƒå°ï¼ˆ+0.07%ï¼‰
4. ğŸ’¡ å»ºè®®ï¼šä¼˜å…ˆä½¿ç”¨æ³¨æ„åŠ›+ç‰¹å¾å·¥ç¨‹

---

## ğŸ¯ å®éªŒæ—¶é—´ä¼°ç®—

| é…ç½® | å•ä¸ªå®éªŒ | 4ä¸ªå®éªŒæ€»è®¡ | 10ä¸ªå®éªŒæ€»è®¡ |
|------|---------|------------|-------------|
| 3 epochs | ~7åˆ†é’Ÿ | ~30åˆ†é’Ÿ | ~70åˆ†é’Ÿ |
| 5 epochs | ~12åˆ†é’Ÿ | ~50åˆ†é’Ÿ | ~120åˆ†é’Ÿ |
| 10 epochs | ~25åˆ†é’Ÿ | ~100åˆ†é’Ÿ | ~250åˆ†é’Ÿ |

**ç¡¬ä»¶**ï¼šNVIDIA GPUï¼ˆCUDAï¼‰

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šCUDAå†…å­˜ä¸è¶³
```bash
# è§£å†³æ–¹æ¡ˆï¼šå‡å°batch size
# åœ¨ config.py ä¸­ä¿®æ”¹
BATCH_SIZE = 128  # ä»256é™åˆ°128
```

### é—®é¢˜2ï¼šè®­ç»ƒå¤ªæ…¢
```bash
# è§£å†³æ–¹æ¡ˆ1ï¼šå‡å°‘epoch
./run_ablation.sh 3

# è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒ
# åœ¨æ¨¡å‹ä¸­å¯ç”¨ autocast
```

### é—®é¢˜3ï¼šæŸä¸ªå®éªŒå¤±è´¥
```python
# è·³è¿‡å¤±è´¥çš„å®éªŒï¼Œæ‰‹åŠ¨è¿è¡Œå…¶ä»–å®éªŒ
study = AblationStudy()
study.run_baseline_experiment(5)
study.run_attention_experiment(5)
# è·³è¿‡å¤±è´¥çš„
study.generate_report()
```

---

## ğŸ“š æ‰©å±•é˜…è¯»

### è®ºæ–‡ä¸­çš„æ¶ˆèå®éªŒç¤ºä¾‹

1. **BERTè®ºæ–‡**ï¼š
   - ç§»é™¤NSPä»»åŠ¡ â†’ -0.5%
   - ç§»é™¤MLM â†’ -15%
   - ç»“è®ºï¼šMLMæ›´é‡è¦

2. **Transformerè®ºæ–‡**ï¼š
   - ç§»é™¤å¤šå¤´æ³¨æ„åŠ› â†’ -2%
   - ç§»é™¤ä½ç½®ç¼–ç  â†’ -5%
   - ç»“è®ºï¼šä¸¤è€…éƒ½å¾ˆé‡è¦

### æˆ‘ä»¬çš„ç›®æ ‡

é€šè¿‡ç³»ç»ŸåŒ–çš„æ¶ˆèå®éªŒï¼š
1. âœ… é‡åŒ–æ¯ä¸ªæ”¹è¿›
2. âœ… å‘ç°æœ€ä¼˜ç»„åˆ
3. âœ… ç”Ÿæˆå®éªŒæŠ¥å‘Š
4. âœ… æ”¯æŒè®ºæ–‡/ä½œä¸š

---

## ğŸš€ ç°åœ¨å¼€å§‹ï¼

```bash
cd /home/xinguanze/class/ml2

# è¿è¡Œæ ‡å‡†æ¶ˆèå®éªŒ
./run_ablation.sh 5

# ç­‰å¾…çº¦50åˆ†é’Ÿ...

# æŸ¥çœ‹æŠ¥å‘Š
cat ablation_results/REPORT.md

# æŸ¥çœ‹å›¾è¡¨
open ablation_results/ablation_comparison.png
```

**ç¥å®éªŒé¡ºåˆ©ï¼ğŸ‰**
